(globalThis["webpackChunkchicken_bro"]=globalThis["webpackChunkchicken_bro"]||[]).push([[947],{4947:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>se});t(702);var l=t(9835),n=t(6970),s=t(499),o=t(5613),i=t.n(o),r=t(1569),c=t(7270),u=t(6928),p=t(1345);const g={class:"container shop-wrapper"},_={class:"shop-title flex items-center justify-between"},v=(0,l._)("p",{class:"text-ub text-outline text-h3 text-negative title"},"Сельская ярмарка",-1),d=(0,l._)("p",null,null,-1),m={class:"shop-inner"},x={class:"row items-end"},b={class:"col-3"},w={class:"arrows"},k={class:"arrows-wrapper"},h={class:"col-9"},f={class:"larek",id:"test"},y={class:"larek-grid"},C={key:0,class:"bg-white q-pa-sm"},z={class:"no-margin text-normal"},F={class:"no-margin text-normal"},q={class:"no-margin text-normal"},U={class:"text-normal"},D=(0,l.Uk)("Купить"),H=["innerHTML"],T={key:1,class:"bg-white q-pa-sm"},$={class:"no-margin text-normal"},j={class:"no-margin text-normal"},L={class:"no-margin text-normal"},M={class:"no-margin text-normal"},S={class:"text-normal"},P=(0,l.Uk)("Купить"),Q=["innerHTML"],W={key:2,class:"bg-white q-pa-sm"},Z={class:"no-margin text-normal"},B={class:"no-margin text-normal"},K={class:"no-margin text-normal"},Y={class:"text-normal"},A=(0,l.Uk)("Купить"),E={key:3,class:"bg-white q-pa-sm"},G={class:"no-margin text-normal"},I={class:"no-margin text-normal"},J={class:"no-margin text-normal"},N={class:"text-normal"},O=(0,l.Uk)("Купить"),R=["src"],V={__name:"Shop",setup(e){const a=(0,u.t)(),t=(0,p.a)(),o=(0,s.iH)(!1),V=(0,s.iH)("eggs"),X=(0,s.iH)("");(0,l.wF)((async()=>{await a.getUser()}));const ee=(0,l.Fl)((()=>(X.value="Покупка невозможна",0!==a.user.chick_house.length||(X.value+="<br>Купите курятник",!1)))),ae=(0,l.Fl)((()=>{if(X.value="Покупка невозможна",a.user.chick_house&&a.user.incubators.length>0){let e=0,t=0;for(let l of a.user.incubators)t+=l.incubator.can_have_eggs,e+=l.eggs.length;return console.log("eggs_total_can_in",t),console.log("eggs_in",e),t>e||(X.value+="<br>Не хватает места в инкубаторах<br>Докупите инкубатор или<br> подождите пока созревают яйца",!1)}return a.user.chick_house||(X.value+="<br>Купите курятник"),0===a.user.incubators.length&&(X.value+="<br>Купите инкубатор"),!1}));async function te(e,t){o.value=!o.value;const l=await r.api.post("/api/data/buy",{item:e,id:t});l.data.status?(0,c.d)("positive",l.data.message):(0,c.d)("negative",l.data.message),await a.getUser(),o.value=!o.value}return(e,a)=>{const r=(0,l.up)("q-btn"),c=(0,l.up)("q-popup-proxy"),u=(0,l.up)("q-page");return(0,l.wg)(),(0,l.j4)(u,{class:"shop"},{default:(0,l.w5)((()=>[(0,l._)("div",g,[(0,l._)("div",_,[(0,l._)("img",{onClick:a[0]||(a[0]=a=>e.$router.back()),class:"text-button back-btn",src:i(),alt:""}),v,d]),(0,l._)("div",m,[(0,l._)("div",x,[(0,l._)("div",b,[(0,l._)("div",w,[(0,l._)("div",k,[(0,l._)("p",{class:(0,n.C_)(["text-ub no-margin text-negative cursor-pointer text-body1",["eggs"===V.value?"text-outline":""]]),onClick:a[1]||(a[1]=e=>V.value="eggs")},"Яйцо",2),(0,l._)("p",{class:(0,n.C_)(["text-ub no-margin text-negative cursor-pointer text-body1",["incubators"===V.value?"text-outline":""]]),onClick:a[2]||(a[2]=e=>V.value="incubators")},"Инкубаторы",2),(0,l._)("p",{class:(0,n.C_)(["text-ub no-margin text-negative cursor-pointer text-body1",["food_pools"===V.value?"text-outline":""]]),onClick:a[3]||(a[3]=e=>V.value="food_pools")},"Кормушки",2),(0,l._)("p",{class:(0,n.C_)(["text-ub no-margin text-negative cursor-pointer text-body1",["water_pools"===V.value?"text-outline":""]]),onClick:a[4]||(a[4]=e=>V.value="water_pools")},"Поилки",2)])])]),(0,l._)("div",h,[(0,l._)("div",f,[(0,l._)("div",y,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)((0,s.SU)(t).shop[V.value],((a,t)=>((0,l.wg)(),(0,l.iD)("div",{class:"larek-grid__item",key:t},[(0,l.Wm)(c,{class:"popup"},{default:(0,l.w5)((()=>["eggs"===V.value?((0,l.wg)(),(0,l.iD)("div",C,[(0,l._)("p",z,(0,n.zw)(a.name),1),(0,l._)("p",F,"Период инкубации :"+(0,n.zw)(a.incubation_period)+" день",1),(0,l._)("p",q,"За время инкубации принесет : "+(0,n.zw)(parseFloat(48*a.incubation_mining*a.incubation_period).toFixed(5)),1),(0,l._)("p",U,"Стоимость: "+(0,n.zw)(a.price),1),(0,s.SU)(ae)?((0,l.wg)(),(0,l.j4)(r,{key:0,flat:"",loading:o.value,color:"negative",onClick:e=>te(V.value,a.id),disable:parseFloat(a.price)>parseFloat(e.$auth.user.balance),class:"no-margin text-ub text-negative text-center cursor-pointer"},{default:(0,l.w5)((()=>[D])),_:2},1032,["loading","onClick","disable"])):((0,l.wg)(),(0,l.iD)("p",{key:1,class:"no-margin text-ub text-negative text-center cursor-pointer text-caption",innerHTML:X.value},null,8,H))])):(0,l.kq)("",!0),"incubators"===V.value?((0,l.wg)(),(0,l.iD)("div",T,[(0,l._)("p",$,(0,n.zw)(a.name),1),(0,l._)("p",j,"Вмещает: "+(0,n.zw)(a.can_have_eggs)+" яиц",1),(0,l._)("p",L,"Единиц заряда: "+(0,n.zw)(a.power_cell_volume),1),(0,l._)("p",M,"Стоимость единицы заряда: "+(0,n.zw)(a.power_cell_cost),1),(0,l._)("p",S,"Стоимость: "+(0,n.zw)(a.price),1),(0,s.SU)(ee)?((0,l.wg)(),(0,l.j4)(r,{key:0,flat:"",loading:o.value,color:"negative",onClick:e=>te(V.value,a.id),disable:parseFloat(a.price)>parseFloat(e.$auth.user.balance),class:"no-margin text-ub text-negative text-center cursor-pointer"},{default:(0,l.w5)((()=>[P])),_:2},1032,["loading","onClick","disable"])):((0,l.wg)(),(0,l.iD)("p",{key:1,class:"no-margin text-ub text-negative text-center cursor-pointer text-caption",innerHTML:X.value},null,8,Q))])):(0,l.kq)("",!0),"food_pools"===V.value?((0,l.wg)(),(0,l.iD)("div",W,[(0,l._)("p",Z,(0,n.zw)(a.name),1),(0,l._)("p",B,"Объем "+(0,n.zw)(a.capacity)+" кг",1),(0,l._)("p",K,"Стоимость единицы наполнения "+(0,n.zw)(a.fill_price)+"/кг",1),(0,l._)("p",Y,"Стоимость: "+(0,n.zw)(a.price),1),(0,l.Wm)(r,{flat:"",loading:o.value,color:"negative",onClick:e=>te(V.value,a.id),disable:parseFloat(a.price)>parseFloat(e.$auth.user.balance),class:"no-margin text-ub text-negative text-center cursor-pointer"},{default:(0,l.w5)((()=>[A])),_:2},1032,["loading","onClick","disable"])])):(0,l.kq)("",!0),"water_pools"===V.value?((0,l.wg)(),(0,l.iD)("div",E,[(0,l._)("p",G,(0,n.zw)(a.name),1),(0,l._)("p",I,"Объем "+(0,n.zw)(a.capacity)+" л",1),(0,l._)("p",J,"Стоимость единицы наполнения "+(0,n.zw)(a.fill_price)+"/л",1),(0,l._)("p",N,"Стоимость: "+(0,n.zw)(a.price),1),(0,l.Wm)(r,{flat:"",loading:o.value,color:"negative",onClick:e=>te(V.value,a.id),disable:parseFloat(a.price)>parseFloat(e.$auth.user.balance),class:"no-margin text-ub text-negative text-center cursor-pointer"},{default:(0,l.w5)((()=>[O])),_:2},1032,["loading","onClick","disable"])])):(0,l.kq)("",!0)])),_:2},1024),(0,l._)("img",{class:(0,n.C_)({"goods-item":"food_pools"===V.value||"water_pools"===V.value}),draggable:"false",src:a.image,alt:""},null,10,R)])))),128))])])])])])])])),_:1})}}};var X=t(9885),ee=t(9133),ae=t(963),te=t(9984),le=t.n(te);const ne=V,se=ne;le()(V,"components",{QPage:X.Z,QPopupProxy:ee.Z,QBtn:ae.Z})},5613:(e,a,t)=>{e.exports=t.p+"img/back.98236efa.png"}}]);