(globalThis["webpackChunkchicken_bro"]=globalThis["webpackChunkchicken_bro"]||[]).push([[947],{4947:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>I});a(702);var n=a(9835),s=a(6970),l=a(499),i=a(5613),o=a.n(i),r=a(1569),c=a(7270),u=a(6928),g=a(1345);const p={class:"container shop-wrapper"},_={class:"shop-title flex items-center justify-between"},v=(0,n._)("p",{class:"text-ub text-outline text-h3 text-negative title"},"Сельская ярмарка",-1),b=(0,n._)("p",null,null,-1),d={class:"shop-inner"},x={class:"row items-end"},m={class:"col-3"},w={class:"arrows"},k={class:"arrows-wrapper"},h={class:"col-9"},y={class:"larek",id:"test"},f={class:"larek-grid"},C={key:0,class:"bg-white q-pa-sm"},z={class:"no-margin text-normal"},F={class:"no-margin text-normal"},H={class:"no-margin text-normal"},q={class:"text-normal"},U=(0,n.Uk)("Купить"),D=["innerHTML"],T={key:1,class:"bg-white q-pa-sm"},j={class:"no-margin text-normal"},L={class:"no-margin text-normal"},M={class:"no-margin text-normal"},S={class:"no-margin text-normal"},P={class:"text-normal"},Q=(0,n.Uk)("Купить"),Z=["innerHTML"],$=["src"],B={__name:"Shop",setup(e){const t=(0,u.t)(),a=(0,g.a)(),i=(0,l.iH)(!1),B=(0,l.iH)("eggs"),K=(0,l.iH)("");(0,n.wF)((async()=>{await t.getUser()}));const W=(0,n.Fl)((()=>(K.value="Покупка невозможна",0!==t.user.chick_house.length||(K.value+="<br>Купите курятник",!1)))),Y=(0,n.Fl)((()=>{if(K.value="Покупка невозможна",t.user.chick_house&&t.user.incubators.length>0){let e=0,a=0;for(let n of t.user.incubators)a+=n.incubator.can_have_eggs,e+=n.eggs.length;return console.log("eggs_total_can_in",a),console.log("eggs_in",e),a>e||(K.value+="<br>Не хватает места в инкубаторах<br>Докупите инкубатор или<br> подождите пока созревают яйца",!1)}return t.user.chick_house||(K.value+="<br>Купите курятник"),0===t.user.incubators.length&&(K.value+="<br>Купите инкубатор"),!1}));async function A(e,a){i.value=!i.value;const n=await r.api.post("/api/data/buy",{item:e,id:a});n.data.status?(0,c.d)("positive",n.data.message):(0,c.d)("negative",n.data.message),await t.getUser(),i.value=!i.value}return(e,t)=>{const r=(0,n.up)("q-btn"),c=(0,n.up)("q-popup-proxy"),u=(0,n.up)("q-page");return(0,n.wg)(),(0,n.j4)(u,{class:"shop"},{default:(0,n.w5)((()=>[(0,n._)("div",p,[(0,n._)("div",_,[(0,n._)("img",{onClick:t[0]||(t[0]=t=>e.$router.back()),class:"text-button back-btn",src:o(),alt:""}),v,b]),(0,n._)("div",d,[(0,n._)("div",x,[(0,n._)("div",m,[(0,n._)("div",w,[(0,n._)("div",k,[(0,n._)("p",{class:(0,s.C_)(["text-ub no-margin text-negative cursor-pointer text-body1",["eggs"===B.value?"text-outline":""]]),onClick:t[1]||(t[1]=e=>B.value="eggs")},"Яйцо",2),(0,n._)("p",{class:(0,s.C_)(["text-ub no-margin text-negative cursor-pointer text-body1",["incubators"===B.value?"text-outline":""]]),onClick:t[2]||(t[2]=e=>B.value="incubators")},"Инкубаторы",2),(0,n._)("p",{class:(0,s.C_)(["text-ub no-margin text-negative cursor-pointer text-body1",["goods"===B.value?"text-outline":""]]),onClick:t[3]||(t[3]=e=>B.value="goods")},"Товары",2)])])]),(0,n._)("div",h,[(0,n._)("div",y,[(0,n._)("div",f,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)((0,l.SU)(a).shop[B.value],((t,a)=>((0,n.wg)(),(0,n.iD)("div",{class:"larek-grid__item",key:a},[(0,n.Wm)(c,{class:"popup"},{default:(0,n.w5)((()=>["eggs"===B.value?((0,n.wg)(),(0,n.iD)("div",C,[(0,n._)("p",z,(0,s.zw)(t.name),1),(0,n._)("p",F,"Период инкубации :"+(0,s.zw)(t.incubation_period)+" день",1),(0,n._)("p",H,"За время инкубации принесет : "+(0,s.zw)(parseFloat(48*t.incubation_mining*t.incubation_period).toFixed(5)),1),(0,n._)("p",q,"Стоимость: "+(0,s.zw)(t.price),1),(0,l.SU)(Y)?((0,n.wg)(),(0,n.j4)(r,{key:0,flat:"",loading:i.value,color:"negative",onClick:e=>A(B.value,t.id),disable:parseFloat(t.price)>parseFloat(e.$auth.user.balance),class:"no-margin text-ub text-negative text-center cursor-pointer"},{default:(0,n.w5)((()=>[U])),_:2},1032,["loading","onClick","disable"])):((0,n.wg)(),(0,n.iD)("p",{key:1,class:"no-margin text-ub text-negative text-center cursor-pointer text-caption",innerHTML:K.value},null,8,D))])):(0,n.kq)("",!0),"incubators"===B.value?((0,n.wg)(),(0,n.iD)("div",T,[(0,n._)("p",j,(0,s.zw)(t.name),1),(0,n._)("p",L,"Вмещает: "+(0,s.zw)(t.can_have_eggs)+" яиц",1),(0,n._)("p",M,"Единиц заряда: "+(0,s.zw)(t.power_cell_volume),1),(0,n._)("p",S,"Стоимость единицы заряда: "+(0,s.zw)(t.power_cell_cost),1),(0,n._)("p",P,"Стоимость: "+(0,s.zw)(t.price),1),(0,l.SU)(W)?((0,n.wg)(),(0,n.j4)(r,{key:0,flat:"",loading:i.value,color:"negative",onClick:e=>A(B.value,t.id),disable:parseFloat(t.price)>parseFloat(e.$auth.user.balance),class:"no-margin text-ub text-negative text-center cursor-pointer"},{default:(0,n.w5)((()=>[Q])),_:2},1032,["loading","onClick","disable"])):((0,n.wg)(),(0,n.iD)("p",{key:1,class:"no-margin text-ub text-negative text-center cursor-pointer text-caption",innerHTML:K.value},null,8,Z))])):(0,n.kq)("",!0)])),_:2},1024),(0,n._)("img",{draggable:"false",src:t.image,alt:""},null,8,$)])))),128))])])])])])])])),_:1})}}};var K=a(9885),W=a(9133),Y=a(963),A=a(9984),E=a.n(A);const G=B,I=G;E()(B,"components",{QPage:K.Z,QPopupProxy:W.Z,QBtn:Y.Z})},5613:(e,t,a)=>{e.exports=a.p+"img/back.98236efa.png"}}]);