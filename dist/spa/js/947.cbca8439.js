(globalThis["webpackChunkchicken_bro"]=globalThis["webpackChunkchicken_bro"]||[]).push([[947],{4947:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>B});a(702);var s=a(9835),n=a(6970),l=a(499),i=a(5613),r=a.n(i),o=a(1569),u=a(7270),c=a(6928),g=a(1345);const p={class:"container shop-wrapper"},v={class:"shop-title flex items-center justify-between"},d=(0,s._)("p",{class:"text-ub text-outline text-h3 text-negative"},"Сельская ярмарка",-1),b=(0,s._)("p",null,null,-1),_={class:"shop-inner"},x={class:"row items-end"},k={class:"col-3"},h={class:"arrows"},w={class:"arrows-wrapper"},m={class:"col-9"},y={class:"larek"},f={class:"larek-grid"},C={class:"no-margin text-normal"},H={class:"text-normal"},U={key:0},D=(0,s.Uk)("Купить"),T=["innerHTML"],q={key:1},F=(0,s.Uk)("Купить"),j=["innerHTML"],L=["src"],M={__name:"Shop",setup(e){const t=(0,c.t)(),a=(0,g.a)(),i=(0,l.iH)(!1),M=(0,l.iH)("eggs"),S=(0,l.iH)("");(0,s.wF)((async()=>{await t.getUser()}));const $=(0,s.Fl)((()=>(S.value="Покупка невозможна",0!==t.user.chick_house.length||(S.value+="<br>Купите курятник",!1)))),z=(0,s.Fl)((()=>{if(S.value="Покупка невозможна",t.user.chick_house&&t.user.incubators.length>0){let e=0,a=0;for(let s of t.user.incubators)a+=s.incubator.can_have_eggs,e+=s.eggs.length;return console.log("eggs_total_can_in",a),console.log("eggs_in",e),a>e||(S.value+="<br>Не хватает места в инкубаторах<br>Докупите инкубатор или<br> подождите пока созревают яйца",!1)}return t.user.chick_house||(S.value+="<br>Купите курятник"),0===t.user.incubators.length&&(S.value+="<br>Купите инкубатор"),!1}));async function P(e,a){i.value=!i.value;const s=await o.api.post("/api/data/buy",{item:e,id:a});s.data.status?(0,u.d)("positive",s.data.message):(0,u.d)("negative",s.data.message),await t.getUser(),i.value=!i.value}return(e,t)=>{const o=(0,s.up)("q-btn"),u=(0,s.up)("q-popup-proxy"),c=(0,s.up)("q-page");return(0,s.wg)(),(0,s.j4)(c,{class:"shop"},{default:(0,s.w5)((()=>[(0,s._)("div",p,[(0,s._)("div",v,[(0,s._)("img",{onClick:t[0]||(t[0]=t=>e.$router.back()),class:"text-button",src:r(),alt:""}),d,b]),(0,s._)("div",_,[(0,s._)("div",x,[(0,s._)("div",k,[(0,s._)("div",h,[(0,s._)("div",w,[(0,s._)("p",{class:(0,n.C_)(["text-ub no-margin text-negative cursor-pointer text-body1",["eggs"===M.value?"text-outline":""]]),onClick:t[1]||(t[1]=e=>M.value="eggs")},"Яйцо",2),(0,s._)("p",{class:(0,n.C_)(["text-ub no-margin text-negative cursor-pointer text-body1",["incubators"===M.value?"text-outline":""]]),onClick:t[2]||(t[2]=e=>M.value="incubators")},"Инкубаторы",2),(0,s._)("p",{class:(0,n.C_)(["text-ub no-margin text-negative cursor-pointer text-body1",["goods"===M.value?"text-outline":""]]),onClick:t[3]||(t[3]=e=>M.value="goods")},"Товары",2)])])]),(0,s._)("div",m,[(0,s._)("div",y,[(0,s._)("div",f,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)((0,l.SU)(a).shop[M.value],((t,a)=>((0,s.wg)(),(0,s.iD)("div",{class:"larek-grid__item",key:a},[(0,s.Wm)(u,{class:"popup"},{default:(0,s.w5)((()=>[(0,s._)("p",C,(0,n.zw)(t.name),1),(0,s._)("p",H,"Стоимость: "+(0,n.zw)(t.price),1),"eggs"===M.value?((0,s.wg)(),(0,s.iD)("div",U,[(0,s.Uk)((0,n.zw)(e.$auth.user.balance)+" ",1),(0,l.SU)(z)?((0,s.wg)(),(0,s.j4)(o,{key:0,flat:"",loading:i.value,color:"negative",onClick:e=>P(M.value,t.id),disable:parseFloat(t.price)>=parseFloat(e.$auth.user.balance),class:"no-margin text-ub text-negative text-center cursor-pointer"},{default:(0,s.w5)((()=>[D])),_:2},1032,["loading","onClick","disable"])):((0,s.wg)(),(0,s.iD)("p",{key:1,class:"no-margin text-ub text-negative text-center cursor-pointer text-caption",innerHTML:S.value},null,8,T))])):(0,s.kq)("",!0),"incubators"===M.value?((0,s.wg)(),(0,s.iD)("div",q,[(0,l.SU)($)?((0,s.wg)(),(0,s.j4)(o,{key:0,flat:"",loading:i.value,color:"negative",onClick:e=>P(M.value,t.id),disable:t.price>=e.$auth.user.balance,class:"no-margin text-ub text-negative text-center cursor-pointer"},{default:(0,s.w5)((()=>[F])),_:2},1032,["loading","onClick","disable"])):((0,s.wg)(),(0,s.iD)("p",{key:1,class:"no-margin text-ub text-negative text-center cursor-pointer text-caption",innerHTML:S.value},null,8,j))])):(0,s.kq)("",!0)])),_:2},1024),(0,s._)("img",{draggable:"false",src:t.image,alt:""},null,8,L)])))),128))])])])])])])])),_:1})}}};var S=a(9885),$=a(9133),z=a(8556),P=a(9984),Q=a.n(P);const Z=M,B=Z;Q()(M,"components",{QPage:S.Z,QPopupProxy:$.Z,QBtn:z.Z})},5613:(e,t,a)=>{e.exports=a.p+"img/back.98236efa.png"}}]);